"use strict";var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},_createClass=function(){function r(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,s){return t&&r(e.prototype,t),s&&r(e,s),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var KeyboardTracker=function(){function y(e,t){var s=this;_classCallCheck(this,y),this.handler=e||null;var r={persistence:!1,history:!1,scope:window};t=_extends({},r,t);var n=!0,a=!1,i=void 0;try{for(var o,l=Object.keys(t)[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var h=o.value;this[h]=t[h]}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}this.keys={},!0===this.persistence&&(this.keys=this.loadState()||{}),this.scope.addEventListener("keydown",function(e){return s.logEvent(e,!0)}),this.scope.addEventListener("keyup",function(e){return s.logEvent(e,!1)})}return _createClass(y,[{key:"saveState",value:function(){localStorage.setItem("keyboard-tracker",JSON.stringify(this.keys))}},{key:"loadState",value:function(){return JSON.parse(localStorage.getItem("keyboard-tracker"))}},{key:"key",value:function(e){return this.keys[e]||null}},{key:"keyExists",value:function(e){return null!==this.key(e)}},{key:"createKey",value:function(e,t){this.keys[e]={key:e,pressed:null,total:0,latest:Date.now(),history:[]}}},{key:"saveKeyPress",value:function(e,t){var s=Date.now();if(!0===t&&(this.keys[e].total++,this.keys[e].latest=s),!0===this.history){var r={timestamp:s};!0===t?r.state="down":(r.state="up",r.duration=s-this.key(e).history[this.key(e).history.length-1].timestamp),this.keys[e].history.push(r)}this.keys[e].pressed=t}},{key:"logEvent",value:function(e,t){var s=e.key;this.keyExists(s)||this.createKey(s),this.key(s).pressed!==t&&(this.saveKeyPress(s,t),!0===this.persistence&&this.saveState(),null!==this.handler&&("function"==typeof this.handler?this.handler(this.key(s)):void 0!==this.handler[s]?this.handler[s](this.key(s)):void 0!==this.handler.default&&this.handler.default(this.key(s))))}}]),y}();